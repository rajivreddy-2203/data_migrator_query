<!DOCTYPE html>
<html>

<head>
  <title>Data Migration Tool</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
  <nav class="navbar">
    <div class="navbar-left">
      <a href="/" class="navbar-title" style="text-decoration:none;">Data Migration Tool</a>
    </div>
    <div class="navbar-right">
      <button type="button" id="manageConnectionsBtn" class="nav-btn">Manage Connections</button>
      <button type="button" id="manageSchedulesBtn" class="nav-btn">Manage Schedules</button>
      <button id="viewHistoryBtn" class="hist-btn" title="View Migration History">
        <span class="hist-btn-content">
          <svg class="hist-icon" width="22" height="22" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="9.5" stroke="#357cf9" stroke-width="2" />
            <path d="M12 7v5l3 2" stroke="#357cf9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          <span class="hist-text">History</span>
        </span>
      </button>


    </div>
  </nav>
  <div class="page-content">
    <div class="form-col">
      <form id="migrateForm">
        <label>Source Connection</label>
        <select id="source"></select>
        <label>Destination Connection</label>
        <select id="destination"></select>
        <label>Source Query</label>
        <textarea id="query" rows="4"></textarea>
        <button type="button" id="previewBtn" class="btn fullwidth">Preview & Map Columns</button>
        <label>Destination Table Name</label>
        <input id="target_table" type="text" name="target_table" />
        <label>Schedule Migration Time</label>
        <input type="time" id="schedule_time" name="schedule_time" value="02:00" />
        <div class="btn-bar">
          <button type="submit" id="migrateBtn" class="btn btn-main">Migrate</button>
          <button type="button" id="scheduleBtn" class="btn">Schedule Migration</button>
        </div>
      </form>
      <div id="result" class="result-div"></div>
      <div id="progressArea" class="progress-ctn" style="display:none;">
        <div id="progressbar" class="progressbar">
          <div id="progressfill" class="progressfill"></div>
        </div>
        <div id="progressText" class="progress-text"></div>
      </div>
    </div>
    <!-- Side panel is hidden by default -->
    <aside class="side-panel-upg" id="sidePanel" style="display:none;">
      <section>
        <div class="side-panel-title">Column Type Mapping</div>
        <div class="side-panel-content" id="typeMapForm"></div>
      </section>
      <section>
        <div class="side-panel-title">Preview Results</div>
        <div class="side-panel-content" id="queryPreview"></div>
      </section>
    </aside>
  </div>
  <script src="{{ url_for('static', filename='index.js') }}"></script>
  <script>
    document.getElementById('manageConnectionsBtn').onclick = () => window.location = '/manage-connections';
    document.getElementById('manageSchedulesBtn').onclick = () => window.location = '/schedules';
    document.getElementById('viewHistoryBtn').onclick = () => window.location = '/migration-history';
  </script>
</body>

</html>